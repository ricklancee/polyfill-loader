<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="author" content="" />
    <meta name="viewport" content="width=device-width">
    <link rel="stylesheet" type="text/css" href="./bower_components/jasmine-core/lib/jasmine-core/jasmine.css">
    <title></title>
</head>
<body>
    <script type="text/javascript" src="./bower_components/jasmine-core/lib/jasmine-core/jasmine.js"></script>
    <script type="text/javascript" src="./bower_components/jasmine-core/lib/jasmine-core/jasmine-html.js"></script>
    <script type="text/javascript" src="./bower_components/jasmine-core/lib/jasmine-core/boot.js"></script>
    <script src="polyfiller.js"></script>
    <script>
      describe("Polyfiller", function() {

        it("should be in the global scope", function() {
          expect(window.polyfiller).not.toBe(undefined);
        });

        describe('loading polyfills', function() {
          var callbackFired = false;

          beforeEach(function(done) {
            polyfiller.addPolyfill('./bower_components/promise-polyfill/promise.js');

            polyfiller.load(function() {
              callbackFired = true;
            });

            window.addEventListener('polyfillsLoaded', function() {
              done();
            });
          });

          it('should be able to add scripts to the head', function() {
            expect(document.querySelector('script[src="./bower_components/promise-polyfill/promise.js"]'))
              .not.toBe(undefined);
            expect(callbackFired).toBe(true);
          });
        });
      });
    </script>
</body>
</html>
